import{a as ee,b as ce}from"./chunk-AJES6YDM.js";import{a as Z,b as pe}from"./chunk-42XNGEAI.js";import"./chunk-ZXGACRG4.js";import{a as p,b as Y}from"./chunk-3FZOACPW.js";import{d as H,e as G,g as se,h as Q,j as X,p as le}from"./chunk-M65OZ3ZA.js";import{D as re,d as W,p as x,r as E,v as M,x as K}from"./chunk-Q7AIZQEA.js";import{$ as a,B as $,Da as z,Kb as c,Ma as m,N as R,P,Q as q,V as b,Va as g,_ as F,_a as N,ab as j,cb as B,d as h,da as v,db as s,eb as l,fb as d,i as O,ib as k,jb as u,kb as J,la as A,lb as V,nb as w,p as U,t as L,ua as _}from"./chunk-PKDUKL24.js";function C(n){n||(A(C),n=a(_));let e=new O(t=>n.onDestroy(t.next.bind(t)));return t=>t.pipe(R(e))}var te=h(()=>{"use strict";c();P();q();});var D,ie=h(()=>{"use strict";c();P();q();re();Y();c();D=class n{http=a(K);baseUrl=p.apiUrl;getDigitalCardBySlug(e){return this.http.get(`${this.baseUrl}/tarjetas/${e}`).pipe(L(t=>!t||!t.data?null:t.data),$(t=>(console.error("Error obteniendo tarjeta digital p\xFAblica:",t),U(null))))}validateDigitalCard(e){return!(!e||typeof e!="object"||typeof e.id!="number"||!e.slug||typeof e.is_active!="boolean"||typeof e.is_public!="boolean"||!e.is_active||!e.is_public||!e.personal_info||!e.personal_info.name)}static \u0275fac=function(t){return new(t||n)};static \u0275prov=b({token:n,factory:n.\u0275fac,providedIn:"root"})}});var S,ne=h(()=>{"use strict";M();c();S=class n{message="Cargando...";static \u0275fac=function(t){return new(t||n)};static \u0275cmp=v({type:n,selectors:[["app-loading-spinner"]],inputs:{message:"message"},standalone:!0,features:[w],decls:11,vars:1,consts:[[1,"flex","flex-col","items-center","justify-center","space-y-4"],[1,"relative"],[1,"w-16","h-16","border-4","border-purple-200","border-t-purple-600","rounded-full","animate-spin"],[1,"absolute","inset-0","w-16","h-16","border-4","border-transparent","border-b-blue-400","rounded-full","animate-spin-reverse"],[1,"text-center"],[1,"text-white","text-lg","font-medium"],[1,"mt-2","flex","justify-center","space-x-1"],[1,"w-2","h-2","bg-purple-400","rounded-full","animate-bounce",2,"animation-delay","0ms"],[1,"w-2","h-2","bg-purple-400","rounded-full","animate-bounce",2,"animation-delay","150ms"],[1,"w-2","h-2","bg-purple-400","rounded-full","animate-bounce",2,"animation-delay","300ms"]],template:function(t,i){t&1&&(s(0,"div",0)(1,"div",1),d(2,"div",2)(3,"div",3),l(),s(4,"div",4)(5,"p",5),u(6),l(),s(7,"div",6),d(8,"div",7)(9,"div",8)(10,"div",9),l()()()),t&2&&(m(6),J(i.message))},dependencies:[x],styles:["@keyframes _ngcontent-%COMP%_spin-reverse{0%{transform:rotate(0)}to{transform:rotate(-360deg)}}.animate-spin-reverse[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_spin-reverse 1s linear infinite}"]})}});var T,oe=h(()=>{"use strict";c();M();c();T=class n{constructor(e){this.platformId=e}generateDynamicManifest(e,t){if(!e)return null;let i=e.name||e.nombre||"Usuario",o=e.title||e.cargo||"Profesional",r=e.location||e.ubicacion||"";return{name:`${i} - Tarjeta Digital`,short_name:i,description:`Tarjeta digital profesional de ${i}, ${o}${r?" en "+r:""}. Acceso directo a toda su informaci\xF3n de contacto.`,start_url:t,display:"standalone",orientation:"portrait-primary",theme_color:"#00ffff",background_color:"#000000",scope:"/",lang:"es-ES",dir:"ltr",categories:["business","productivity","social"],prefer_related_applications:!1,icons:[{src:"assets/pwa/apple-touch-icon-180x180.png",sizes:"180x180",type:"image/png",purpose:"any"},{src:"assets/pwa/icon_JE_192.png",sizes:"192x192",type:"image/png",purpose:"any"},{src:"assets/pwa/icon_JE_512_maskable.png",sizes:"512x512",type:"image/png",purpose:"maskable"},{src:"assets/pwa/icon_JE_512.png",sizes:"512x512",type:"image/png",purpose:"any"},{src:"assets/pwa/logo_JE_1024.png",sizes:"1024x1024",type:"image/png",purpose:"any"}],shortcuts:[{name:`Ver Tarjeta de ${i}`,short_name:"Tarjeta",description:`Acceso directo a la tarjeta digital de ${i}`,url:t,icons:[{src:"assets/pwa/icon_JE_192.png",sizes:"192x192",type:"image/png"}]}],share_target:{action:t,method:"GET",params:{title:"title",text:"text",url:"url"}},screenshots:[{src:"assets/pwa/screenshot-wide.png",sizes:"1280x720",type:"image/png",form_factor:"wide",label:`Vista desktop de la tarjeta digital de ${i}`},{src:"assets/pwa/screenshot-narrow.png",sizes:"360x640",type:"image/png",form_factor:"narrow",label:`Vista m\xF3vil de la tarjeta digital de ${i}`}],protocol_handlers:[{protocol:"mailto",url:`${t}?email=%s`}]}}updateManifestLink(e,t){if(!E(this.platformId))return;let i=this.generateDynamicManifest(e,t);if(!i)return;let o=document.querySelector('link[rel="manifest"]');o&&o.remove();let r=new Blob([JSON.stringify(i,null,2)],{type:"application/json"}),y=URL.createObjectURL(r),f=document.createElement("link");f.rel="manifest",f.href=y,document.head.appendChild(f),console.log("[Manifest] Updated dynamic manifest for user:",e.name||e.nombre),console.log("[Manifest] Start URL:",t)}removeOldManifestURL(){if(!E(this.platformId))return;let e=document.querySelector('link[rel="manifest"]');e&&e.href.startsWith("blob:")&&URL.revokeObjectURL(e.href)}static \u0275fac=function(t){return new(t||n)(F(z))};static \u0275prov=b({token:n,factory:n.\u0275fac,providedIn:"root"})}});function de(n,e){n&1&&(s(0,"div",1),d(1,"app-loading-spinner",5),l())}function ue(n,e){if(n&1&&(s(0,"div",2)(1,"div",6)(2,"h1",7),u(3,"404"),l(),s(4,"h2",8),u(5," Tarjeta no encontrada "),l(),s(6,"p",9),u(7),l(),s(8,"a",10),u(9," Volver al inicio "),l()()()),n&2){let t=k();m(7),V(" ",t.error()," ")}}function fe(n,e){if(n&1&&(s(0,"div",3),d(1,"app-digital-card",11),l()),n&2){let t=k();m(),j("cardData",t.cardData())("hideShareButtons",!1)("shareUrl",t.absoluteCardUrl())}}var ae,ge=h(()=>{c();M();le();te();se();ce();ie();ne();pe();oe();Y();c();ae=class n{route=a(Q);router=a(X);meta=a(H);title=a(G);document=a(W);publicCardService=a(D);manifestService=a(T);destroyRef=a(_);cardData=g(null);isLoading=g(!0);error=g(null);absoluteCardUrl=g("");ngOnInit(){this.route.params.pipe(C(this.destroyRef)).subscribe(e=>{let t=e.slug;t?this.loadCard(t):this.handleError("URL no v\xE1lida")})}loadCard(e){this.isLoading.set(!0),this.error.set(null),this.publicCardService.getDigitalCardBySlug(e).pipe(C(this.destroyRef)).subscribe({next:t=>{if(t&&this.publicCardService.validateDigitalCard(t)){this.cardData.set(t);let i=`${p.siteUrl}/tarjeta/${t.slug}`;this.absoluteCardUrl.set(i),this.configureMetaTags(t),this.addStructuredData(t),this.manifestService.updateManifestLink(t,i),this.isLoading.set(!1)}else this.handleError("Esta tarjeta no est\xE1 disponible p\xFAblicamente")},error:t=>{console.error("Error loading digital card:",t),this.handleError("Error al cargar la tarjeta digital")}})}configureMetaTags(e){let t=e.personal_info?.name||"Tarjeta Digital",i=e.personal_info?.title||"",o=e.about_info?.description||`Tarjeta digital de ${t}`,r=i?`${t} - ${i}`:t,y=`${p.siteUrl}/tarjeta/${e.slug}`,f=this.getAbsoluteImageUrl(e.personal_info?.photo);this.title.setTitle(r),this.removeExistingMetaTags(),this.meta.addTag({name:"description",content:o}),this.meta.addTag({name:"keywords",content:this.generateKeywords(e)}),this.meta.addTag({name:"author",content:t}),this.meta.addTag({name:"robots",content:"index, follow"}),this.meta.addTag({rel:"canonical",href:y}),this.meta.addTag({property:"og:title",content:r}),this.meta.addTag({property:"og:description",content:o}),this.meta.addTag({property:"og:type",content:"profile"}),this.meta.addTag({property:"og:url",content:y}),this.meta.addTag({property:"og:site_name",content:p.siteName}),this.meta.addTag({property:"og:locale",content:"es_ES"}),this.meta.addTag({property:"og:updated_time",content:new Date().toISOString()}),this.meta.addTag({property:"og:image",content:f}),this.meta.addTag({property:"og:image:width",content:"1200"}),this.meta.addTag({property:"og:image:height",content:"630"}),this.meta.addTag({property:"og:image:type",content:"image/jpeg"}),this.meta.addTag({property:"og:image:alt",content:`Foto de perfil de ${t}`}),e.personal_info?.name&&(this.meta.addTag({property:"profile:first_name",content:e.personal_info.name.split(" ")[0]}),this.meta.addTag({property:"profile:last_name",content:e.personal_info.name.split(" ").slice(1).join(" ")}),this.meta.addTag({property:"profile:username",content:e.slug})),this.meta.addTag({name:"twitter:card",content:"summary_large_image"}),this.meta.addTag({name:"twitter:title",content:r}),this.meta.addTag({name:"twitter:description",content:o}),this.meta.addTag({name:"twitter:image",content:f}),this.meta.addTag({name:"twitter:image:alt",content:`Foto de perfil de ${t}`}),e.contact_info?.twitter&&this.meta.addTag({name:"twitter:creator",content:`@${e.contact_info.twitter}`}),e.personal_info?.title&&this.meta.addTag({name:"profile:job_title",content:e.personal_info.title}),e.contact_info?.email&&this.meta.addTag({name:"contact:email",content:e.contact_info.email}),e.contact_info?.phone&&this.meta.addTag({name:"contact:phone_number",content:e.contact_info.phone})}getAbsoluteImageUrl(e){return`${p.siteUrl}${p.defaultImage}`}addImageOptimizationParams(e){return e.includes("?")||e.includes(p.siteUrl),e}generateKeywords(e){let t=["tarjeta digital","perfil profesional","contacto"];if(e.personal_info?.name&&t.push(e.personal_info.name.toLowerCase()),e.personal_info?.title&&t.push(e.personal_info.title.toLowerCase()),e.about_info?.description){let i=e.about_info.description.toLowerCase().split(" ").filter(o=>o.length>4&&!["este","esta","para","como","desde","donde","cuando"].includes(o)).slice(0,3);t.push(...i)}return t.join(", ")}addStructuredData(e){this.removeExistingStructuredData();let t={"@context":"https://schema.org","@type":"Person",name:e.personal_info?.name||"Tarjeta Digital",jobTitle:e.personal_info?.title||"",description:e.about_info?.description||`Tarjeta digital de ${e.personal_info?.name}`,url:`${p.siteUrl}/tarjeta/${e.slug}`,image:this.getAbsoluteImageUrl(e.personal_info?.photo),sameAs:this.getSocialMediaUrls(e),contactPoint:{"@type":"ContactPoint",email:e.contact_info?.email||"",telephone:e.contact_info?.phone||"",contactType:"personal"},address:e.personal_info?.location?{"@type":"Place",name:e.personal_info.location}:void 0,knowsAbout:this.extractSkillsFromCard(e),hasOccupation:e.personal_info?.title?{"@type":"Occupation",name:e.personal_info.title}:void 0};Object.keys(t).forEach(o=>{(t[o]===void 0||t[o]===""||Array.isArray(t[o])&&t[o].length===0)&&delete t[o]});let i=this.document.createElement("script");i.type="application/ld+json",i.textContent=JSON.stringify(t,null,2),i.id="structured-data-person",this.document.head.appendChild(i)}removeExistingMetaTags(){['name="description"','name="keywords"','name="author"','name="robots"','property="og:title"','property="og:description"','property="og:type"','property="og:url"','property="og:image"','property="og:image:width"','property="og:image:height"','property="og:image:type"','property="og:image:alt"','property="og:updated_time"','property="profile:first_name"','property="profile:last_name"','property="profile:username"','name="profile:job_title"','name="twitter:card"','name="twitter:title"','name="twitter:description"','name="twitter:image"','name="twitter:image:alt"','name="twitter:creator"','name="contact:email"','name="contact:phone_number"'].forEach(i=>{let o=this.document.querySelector(`meta[${i}]`);o&&o.remove()});let t=this.document.querySelector('link[rel="canonical"]');t&&t.remove()}removeExistingStructuredData(){let e=this.document.getElementById("structured-data-person");e&&e.remove()}getSocialMediaUrls(e){let t=[];if(e.contact_info?.website&&t.push(e.contact_info.website),e.contact_info?.linkedin){let i=e.contact_info.linkedin.startsWith("http")?e.contact_info.linkedin:`https://linkedin.com/in/${e.contact_info.linkedin}`;t.push(i)}if(e.contact_info?.twitter){let i=e.contact_info.twitter.startsWith("http")?e.contact_info.twitter:`https://twitter.com/${e.contact_info.twitter}`;t.push(i)}if(e.contact_info?.instagram){let i=e.contact_info.instagram.startsWith("http")?e.contact_info.instagram:`https://instagram.com/${e.contact_info.instagram}`;t.push(i)}return t}extractSkillsFromCard(e){let t=[];if(e.about_info?.skills&&Array.isArray(e.about_info.skills)&&t.push(...e.about_info.skills),e.about_info?.description){let o=this.extractSkillsFromDescription(e.about_info.description);t.push(...o)}return[...new Set(t)].slice(0,8)}extractSkillsFromDescription(e){if(!e)return[];let t=["javascript","typescript","angular","react","vue","node","python","php","java","html","css","sass","tailwind","bootstrap","desarrollo","programaci\xF3n","dise\xF1o","marketing","seo","ux","ui","gesti\xF3n","liderazgo","an\xE1lisis","consultor\xEDa","estrategia"],i=[],o=e.toLowerCase();return t.forEach(r=>{o.includes(r)&&i.push(r.charAt(0).toUpperCase()+r.slice(1))}),i.slice(0,5)}handleError(e){this.error.set(e),this.isLoading.set(!1),this.cardData.set(null),this.title.setTitle("Tarjeta no encontrada"),this.meta.updateTag({name:"description",content:"La tarjeta digital solicitada no est\xE1 disponible."})}ngOnDestroy(){this.manifestService.removeOldManifestURL()}static \u0275fac=function(t){return new(t||n)};static \u0275cmp=v({type:n,selectors:[["app-public-card"]],standalone:!0,features:[w],decls:5,vars:2,consts:[[1,"min-h-screen","bg-gradient-to-br","from-slate-900","via-purple-900","to-slate-900"],[1,"flex","justify-center","items-center","min-h-screen"],[1,"flex","flex-col","items-center","justify-center","min-h-screen","text-center","px-4"],[1,"relative","z-10","flex","justify-center","items-center","min-h-screen","py-8","px-4"],[3,"userCard"],["message","Cargando tarjeta digital..."],[1,"max-w-md"],[1,"text-6xl","font-bold","text-white","mb-4"],[1,"text-2xl","font-semibold","text-gray-300","mb-4"],[1,"text-gray-400","mb-8"],["routerLink","/",1,"bg-purple-600","hover:bg-purple-700","text-white","font-medium","py-3","px-6","rounded-lg","transition-colors","duration-200"],[3,"cardData","hideShareButtons","shareUrl"]],template:function(t,i){t&1&&(s(0,"div",0),N(1,de,2,0,"div",1)(2,ue,10,1,"div",2)(3,fe,2,3,"div",3),l(),d(4,"app-pwa-install",4)),t&2&&(m(),B(i.isLoading()?1:i.error()?2:3),m(3),j("userCard",i.cardData()))},dependencies:[x,ee,S,Z],styles:["[_nghost-%COMP%]{display:block;min-height:100vh}"]})}});ge();export{ae as PublicCardComponent};
