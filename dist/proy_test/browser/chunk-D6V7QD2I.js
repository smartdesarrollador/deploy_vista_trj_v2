import{d as B,e as W,g as et,h as K,j as V,p as nt}from"./chunk-BOHITBXD.js";import{a as J,b as it}from"./chunk-ROFSVCVH.js";import{a as l,b as H}from"./chunk-BBJ7YBMY.js";import{A as tt,d as A,m as v,s as N,u as z}from"./chunk-UNEY7QXV.js";import{$ as a,B as E,Kb as m,Ma as u,N as I,P as O,Q as M,V as $,Va as f,_a as R,ab as U,cb as L,d as g,da as h,db as r,eb as s,fb as d,i as T,ib as w,jb as c,kb as F,la as P,lb as q,nb as y,p as j,t as k,ua as b}from"./chunk-PKDUKL24.js";function _(i){i||(P(_),i=a(b));let t=new T(e=>i.onDestroy(e.next.bind(e)));return e=>e.pipe(I(t))}var G=g(()=>{"use strict";m();O();M();});var C,X=g(()=>{"use strict";m();O();M();tt();H();m();C=class i{http=a(z);baseUrl=l.apiUrl;getDigitalCardBySlug(t){return this.http.get(`${this.baseUrl}/tarjetas/${t}`).pipe(k(e=>!e||!e.data?null:e.data),E(e=>(console.error("Error obteniendo tarjeta digital p\xFAblica:",e),j(null))))}validateDigitalCard(t){return!(!t||typeof t!="object"||typeof t.id!="number"||!t.slug||typeof t.is_active!="boolean"||typeof t.is_public!="boolean"||!t.is_active||!t.is_public||!t.personal_info||!t.personal_info.name)}static \u0275fac=function(e){return new(e||i)};static \u0275prov=$({token:i,factory:i.\u0275fac,providedIn:"root"})}});var x,Y=g(()=>{"use strict";N();m();x=class i{message="Cargando...";static \u0275fac=function(e){return new(e||i)};static \u0275cmp=h({type:i,selectors:[["app-loading-spinner"]],inputs:{message:"message"},standalone:!0,features:[y],decls:11,vars:1,consts:[[1,"flex","flex-col","items-center","justify-center","space-y-4"],[1,"relative"],[1,"w-16","h-16","border-4","border-purple-200","border-t-purple-600","rounded-full","animate-spin"],[1,"absolute","inset-0","w-16","h-16","border-4","border-transparent","border-b-blue-400","rounded-full","animate-spin-reverse"],[1,"text-center"],[1,"text-white","text-lg","font-medium"],[1,"mt-2","flex","justify-center","space-x-1"],[1,"w-2","h-2","bg-purple-400","rounded-full","animate-bounce",2,"animation-delay","0ms"],[1,"w-2","h-2","bg-purple-400","rounded-full","animate-bounce",2,"animation-delay","150ms"],[1,"w-2","h-2","bg-purple-400","rounded-full","animate-bounce",2,"animation-delay","300ms"]],template:function(e,n){e&1&&(r(0,"div",0)(1,"div",1),d(2,"div",2)(3,"div",3),s(),r(4,"div",4)(5,"p",5),c(6),s(),r(7,"div",6),d(8,"div",7)(9,"div",8)(10,"div",9),s()()()),e&2&&(u(6),F(n.message))},dependencies:[v],styles:["@keyframes _ngcontent-%COMP%_spin-reverse{0%{transform:rotate(0)}to{transform:rotate(-360deg)}}.animate-spin-reverse[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_spin-reverse 1s linear infinite}"]})}});function at(i,t){i&1&&(r(0,"div",1),d(1,"app-loading-spinner",4),s())}function rt(i,t){if(i&1&&(r(0,"div",2)(1,"div",5)(2,"h1",6),c(3,"404"),s(),r(4,"h2",7),c(5," Tarjeta no encontrada "),s(),r(6,"p",8),c(7),s(),r(8,"a",9),c(9," Volver al inicio "),s()()()),i&2){let e=w();u(7),q(" ",e.error()," ")}}function st(i,t){if(i&1&&(r(0,"div",3),d(1,"app-digital-card",10),s()),i&2){let e=w();u(),U("cardData",e.cardData())("hideShareButtons",!1)}}var Z,lt=g(()=>{m();N();nt();G();et();it();X();Y();H();m();Z=class i{route=a(K);router=a(V);meta=a(B);title=a(W);document=a(A);publicCardService=a(C);destroyRef=a(b);cardData=f(null);isLoading=f(!0);error=f(null);ngOnInit(){this.route.params.pipe(_(this.destroyRef)).subscribe(t=>{let e=t.slug;e?this.loadCard(e):this.handleError("URL no v\xE1lida")})}loadCard(t){this.isLoading.set(!0),this.error.set(null),this.publicCardService.getDigitalCardBySlug(t).pipe(_(this.destroyRef)).subscribe({next:e=>{e&&this.publicCardService.validateDigitalCard(e)?(this.cardData.set(e),this.configureMetaTags(e),this.addStructuredData(e),this.isLoading.set(!1)):this.handleError("Esta tarjeta no est\xE1 disponible p\xFAblicamente")},error:e=>{console.error("Error loading digital card:",e),this.handleError("Error al cargar la tarjeta digital")}})}configureMetaTags(t){let e=t.personal_info?.name||"Tarjeta Digital",n=t.personal_info?.title||"",o=t.about_info?.description||`Tarjeta digital de ${e}`,p=n?`${e} - ${n}`:e,D=`${l.siteUrl}/tarjeta/${t.slug}`,S=this.getAbsoluteImageUrl(t.personal_info?.photo);this.title.setTitle(p),this.meta.updateTag({name:"description",content:o}),this.meta.updateTag({name:"keywords",content:this.generateKeywords(t)}),this.meta.updateTag({name:"author",content:e}),this.meta.updateTag({name:"robots",content:"index, follow"}),this.meta.updateTag({name:"canonical",content:D}),this.meta.updateTag({property:"og:title",content:p}),this.meta.updateTag({property:"og:description",content:o}),this.meta.updateTag({property:"og:type",content:"profile"}),this.meta.updateTag({property:"og:url",content:D}),this.meta.updateTag({property:"og:site_name",content:l.siteName}),this.meta.updateTag({property:"og:locale",content:"es_ES"}),this.meta.updateTag({property:"og:updated_time",content:new Date().toISOString()}),this.meta.updateTag({property:"og:image",content:S}),this.meta.updateTag({property:"og:image:width",content:"1200"}),this.meta.updateTag({property:"og:image:height",content:"630"}),this.meta.updateTag({property:"og:image:type",content:"image/jpeg"}),this.meta.updateTag({property:"og:image:alt",content:`Foto de perfil de ${e}`}),t.personal_info?.name&&(this.meta.updateTag({property:"profile:first_name",content:t.personal_info.name.split(" ")[0]}),this.meta.updateTag({property:"profile:last_name",content:t.personal_info.name.split(" ").slice(1).join(" ")}),this.meta.updateTag({property:"profile:username",content:t.slug})),this.meta.updateTag({name:"twitter:card",content:"summary_large_image"}),this.meta.updateTag({name:"twitter:title",content:p}),this.meta.updateTag({name:"twitter:description",content:o}),this.meta.updateTag({name:"twitter:image",content:S}),this.meta.updateTag({name:"twitter:image:alt",content:`Foto de perfil de ${e}`}),t.contact_info?.twitter&&this.meta.updateTag({name:"twitter:creator",content:`@${t.contact_info.twitter}`}),t.personal_info?.title&&this.meta.updateTag({name:"profile:job_title",content:t.personal_info.title}),t.contact_info?.email&&this.meta.updateTag({name:"contact:email",content:t.contact_info.email}),t.contact_info?.phone&&this.meta.updateTag({name:"contact:phone_number",content:t.contact_info.phone})}getAbsoluteImageUrl(t){if(!t)return`${l.siteUrl}${l.defaultImage}`;if(t.startsWith("http://")||t.startsWith("https://"))return this.addImageOptimizationParams(t);let e=`${l.urlDominioApi}/${t}`;return this.addImageOptimizationParams(e)}addImageOptimizationParams(t){return t.includes("?")||t.includes(l.siteUrl),t}generateKeywords(t){let e=["tarjeta digital","perfil profesional","contacto"];if(t.personal_info?.name&&e.push(t.personal_info.name.toLowerCase()),t.personal_info?.title&&e.push(t.personal_info.title.toLowerCase()),t.about_info?.description){let n=t.about_info.description.toLowerCase().split(" ").filter(o=>o.length>4&&!["este","esta","para","como","desde","donde","cuando"].includes(o)).slice(0,3);e.push(...n)}return e.join(", ")}addStructuredData(t){this.removeExistingStructuredData();let e={"@context":"https://schema.org","@type":"Person",name:t.personal_info?.name||"Tarjeta Digital",jobTitle:t.personal_info?.title||"",description:t.about_info?.description||`Tarjeta digital de ${t.personal_info?.name}`,url:`${l.siteUrl}/tarjeta/${t.slug}`,image:this.getAbsoluteImageUrl(t.personal_info?.photo),sameAs:this.getSocialMediaUrls(t),contactPoint:{"@type":"ContactPoint",email:t.contact_info?.email||"",telephone:t.contact_info?.phone||"",contactType:"personal"},address:t.personal_info?.location?{"@type":"Place",name:t.personal_info.location}:void 0,knowsAbout:this.extractSkillsFromCard(t),hasOccupation:t.personal_info?.title?{"@type":"Occupation",name:t.personal_info.title}:void 0};Object.keys(e).forEach(o=>{(e[o]===void 0||e[o]===""||Array.isArray(e[o])&&e[o].length===0)&&delete e[o]});let n=this.document.createElement("script");n.type="application/ld+json",n.textContent=JSON.stringify(e,null,2),n.id="structured-data-person",this.document.head.appendChild(n)}removeExistingStructuredData(){let t=this.document.getElementById("structured-data-person");t&&t.remove()}getSocialMediaUrls(t){let e=[];if(t.contact_info?.website&&e.push(t.contact_info.website),t.contact_info?.linkedin){let n=t.contact_info.linkedin.startsWith("http")?t.contact_info.linkedin:`https://linkedin.com/in/${t.contact_info.linkedin}`;e.push(n)}if(t.contact_info?.twitter){let n=t.contact_info.twitter.startsWith("http")?t.contact_info.twitter:`https://twitter.com/${t.contact_info.twitter}`;e.push(n)}if(t.contact_info?.instagram){let n=t.contact_info.instagram.startsWith("http")?t.contact_info.instagram:`https://instagram.com/${t.contact_info.instagram}`;e.push(n)}return e}extractSkillsFromCard(t){let e=[];if(t.about_info?.skills&&Array.isArray(t.about_info.skills)&&e.push(...t.about_info.skills),t.about_info?.description){let o=this.extractSkillsFromDescription(t.about_info.description);e.push(...o)}return[...new Set(e)].slice(0,8)}extractSkillsFromDescription(t){if(!t)return[];let e=["javascript","typescript","angular","react","vue","node","python","php","java","html","css","sass","tailwind","bootstrap","desarrollo","programaci\xF3n","dise\xF1o","marketing","seo","ux","ui","gesti\xF3n","liderazgo","an\xE1lisis","consultor\xEDa","estrategia"],n=[],o=t.toLowerCase();return e.forEach(p=>{o.includes(p)&&n.push(p.charAt(0).toUpperCase()+p.slice(1))}),n.slice(0,5)}handleError(t){this.error.set(t),this.isLoading.set(!1),this.cardData.set(null),this.title.setTitle("Tarjeta no encontrada"),this.meta.updateTag({name:"description",content:"La tarjeta digital solicitada no est\xE1 disponible."})}static \u0275fac=function(e){return new(e||i)};static \u0275cmp=h({type:i,selectors:[["app-public-card"]],standalone:!0,features:[y],decls:4,vars:1,consts:[[1,"min-h-screen","bg-gradient-to-br","from-slate-900","via-purple-900","to-slate-900"],[1,"flex","justify-center","items-center","min-h-screen"],[1,"flex","flex-col","items-center","justify-center","min-h-screen","text-center","px-4"],[1,"relative","z-10","flex","justify-center","items-center","min-h-screen","py-8","px-4"],["message","Cargando tarjeta digital..."],[1,"max-w-md"],[1,"text-6xl","font-bold","text-white","mb-4"],[1,"text-2xl","font-semibold","text-gray-300","mb-4"],[1,"text-gray-400","mb-8"],["routerLink","/",1,"bg-purple-600","hover:bg-purple-700","text-white","font-medium","py-3","px-6","rounded-lg","transition-colors","duration-200"],[3,"cardData","hideShareButtons"]],template:function(e,n){e&1&&(r(0,"div",0),R(1,at,2,0,"div",1)(2,rt,10,1,"div",2)(3,st,2,2,"div",3),s()),e&2&&(u(),L(n.isLoading()?1:n.error()?2:3))},dependencies:[v,J,x],styles:["[_nghost-%COMP%]{display:block;min-height:100vh}"]})}});lt();export{Z as PublicCardComponent};
