import{a as M,b as W}from"./chunk-NIVGOD3O.js";import{a as P,b as V}from"./chunk-3F6VRETE.js";import{a as h,b as K,c as O,d as J,e as I,f as G}from"./chunk-JYXNK4YA.js";import"./chunk-4ZZBJIP4.js";import{a as L,b as z}from"./chunk-2J2JCRW5.js";import"./chunk-A555SWTS.js";import{a as l,b as B}from"./chunk-KUV4AAZE.js";import{A as $,G as q,b as S,h as k,j as F,u as j,v as E,x as N,y as U}from"./chunk-G2ZNTVWC.js";import{$ as o,Lb as D,Ma as m,Va as c,_a as C,ab as u,cb as T,d as R,da as v,db as r,eb as s,fb as g,ib as f,jb as d,lb as w,nb as x,ua as b}from"./chunk-QO2NU5YS.js";function H(a,t){a&1&&(r(0,"div",1),g(1,"app-loading-spinner",5),s())}function Q(a,t){if(a&1&&(r(0,"div",2)(1,"div",6)(2,"h1",7),d(3,"404"),s(),r(4,"h2",8),d(5," Tarjeta no encontrada "),s(),r(6,"p",9),d(7),s(),r(8,"a",10),d(9," Volver al inicio "),s()()()),a&2){let e=f();m(7),w(" ",e.error()," ")}}function X(a,t){if(a&1&&(r(0,"div",3),g(1,"app-digital-card",11),s()),a&2){let e=f();m(),u("cardData",e.cardData())("hideShareButtons",!1)("shareUrl",e.absoluteCardUrl())}}var A,Y=R(()=>{D();F();q();K();N();W();J();V();z();G();B();D();A=class a{route=o(U);router=o($);meta=o(j);title=o(E);document=o(S);publicCardService=o(O);manifestService=o(I);destroyRef=o(b);cardData=c(null);isLoading=c(!0);error=c(null);absoluteCardUrl=c("");ngOnInit(){this.route.params.pipe(h(this.destroyRef)).subscribe(t=>{let e=t.slug;e?this.loadCard(e):this.handleError("URL no v\xE1lida")})}loadCard(t){this.isLoading.set(!0),this.error.set(null),this.publicCardService.getDigitalCardBySlug(t).pipe(h(this.destroyRef)).subscribe({next:e=>{if(e&&this.publicCardService.validateDigitalCard(e)){this.cardData.set(e);let i=`${l.siteUrl}/tarjeta/${e.slug}`;this.absoluteCardUrl.set(i),this.configureMetaTags(e),this.addStructuredData(e),this.manifestService.updateManifestLink(e,i),this.isLoading.set(!1)}else this.handleError("Esta tarjeta no est\xE1 disponible p\xFAblicamente")},error:e=>{console.error("Error loading digital card:",e),this.handleError("Error al cargar la tarjeta digital")}})}configureMetaTags(t){let e=t.personal_info?.name||"Tarjeta Digital",i=t.personal_info?.title||"",n=t.about_info?.description||`Tarjeta digital de ${e}`,p=i?`${e} - ${i}`:e,y=`${l.siteUrl}/tarjeta/${t.slug}`,_=this.getAbsoluteImageUrl(t.personal_info?.photo);this.title.setTitle(p),this.removeExistingMetaTags(),this.meta.addTag({name:"description",content:n}),this.meta.addTag({name:"keywords",content:this.generateKeywords(t)}),this.meta.addTag({name:"author",content:e}),this.meta.addTag({name:"robots",content:"index, follow"}),this.meta.addTag({rel:"canonical",href:y}),this.meta.addTag({property:"og:title",content:p}),this.meta.addTag({property:"og:description",content:n}),this.meta.addTag({property:"og:type",content:"profile"}),this.meta.addTag({property:"og:url",content:y}),this.meta.addTag({property:"og:site_name",content:l.siteName}),this.meta.addTag({property:"og:locale",content:"es_ES"}),this.meta.addTag({property:"og:updated_time",content:new Date().toISOString()}),this.meta.addTag({property:"og:image",content:_}),this.meta.addTag({property:"og:image:width",content:"1200"}),this.meta.addTag({property:"og:image:height",content:"630"}),this.meta.addTag({property:"og:image:type",content:"image/jpeg"}),this.meta.addTag({property:"og:image:alt",content:`Foto de perfil de ${e}`}),t.personal_info?.name&&(this.meta.addTag({property:"profile:first_name",content:t.personal_info.name.split(" ")[0]}),this.meta.addTag({property:"profile:last_name",content:t.personal_info.name.split(" ").slice(1).join(" ")}),this.meta.addTag({property:"profile:username",content:t.slug})),this.meta.addTag({name:"twitter:card",content:"summary_large_image"}),this.meta.addTag({name:"twitter:title",content:p}),this.meta.addTag({name:"twitter:description",content:n}),this.meta.addTag({name:"twitter:image",content:_}),this.meta.addTag({name:"twitter:image:alt",content:`Foto de perfil de ${e}`}),t.contact_info?.twitter&&this.meta.addTag({name:"twitter:creator",content:`@${t.contact_info.twitter}`}),t.personal_info?.title&&this.meta.addTag({name:"profile:job_title",content:t.personal_info.title}),t.contact_info?.email&&this.meta.addTag({name:"contact:email",content:t.contact_info.email}),t.contact_info?.phone&&this.meta.addTag({name:"contact:phone_number",content:t.contact_info.phone})}getAbsoluteImageUrl(t){return`${l.siteUrl}${l.defaultImage}`}addImageOptimizationParams(t){return t.includes("?")||t.includes(l.siteUrl),t}generateKeywords(t){let e=["tarjeta digital","perfil profesional","contacto"];if(t.personal_info?.name&&e.push(t.personal_info.name.toLowerCase()),t.personal_info?.title&&e.push(t.personal_info.title.toLowerCase()),t.about_info?.description){let i=t.about_info.description.toLowerCase().split(" ").filter(n=>n.length>4&&!["este","esta","para","como","desde","donde","cuando"].includes(n)).slice(0,3);e.push(...i)}return e.join(", ")}addStructuredData(t){this.removeExistingStructuredData();let e={"@context":"https://schema.org","@type":"Person",name:t.personal_info?.name||"Tarjeta Digital",jobTitle:t.personal_info?.title||"",description:t.about_info?.description||`Tarjeta digital de ${t.personal_info?.name}`,url:`${l.siteUrl}/tarjeta/${t.slug}`,image:this.getAbsoluteImageUrl(t.personal_info?.photo),sameAs:this.getSocialMediaUrls(t),contactPoint:{"@type":"ContactPoint",email:t.contact_info?.email||"",telephone:t.contact_info?.phone||"",contactType:"personal"},address:t.personal_info?.location?{"@type":"Place",name:t.personal_info.location}:void 0,knowsAbout:this.extractSkillsFromCard(t),hasOccupation:t.personal_info?.title?{"@type":"Occupation",name:t.personal_info.title}:void 0};Object.keys(e).forEach(n=>{(e[n]===void 0||e[n]===""||Array.isArray(e[n])&&e[n].length===0)&&delete e[n]});let i=this.document.createElement("script");i.type="application/ld+json",i.textContent=JSON.stringify(e,null,2),i.id="structured-data-person",this.document.head.appendChild(i)}removeExistingMetaTags(){['name="description"','name="keywords"','name="author"','name="robots"','property="og:title"','property="og:description"','property="og:type"','property="og:url"','property="og:image"','property="og:image:width"','property="og:image:height"','property="og:image:type"','property="og:image:alt"','property="og:updated_time"','property="profile:first_name"','property="profile:last_name"','property="profile:username"','name="profile:job_title"','name="twitter:card"','name="twitter:title"','name="twitter:description"','name="twitter:image"','name="twitter:image:alt"','name="twitter:creator"','name="contact:email"','name="contact:phone_number"'].forEach(i=>{let n=this.document.querySelector(`meta[${i}]`);n&&n.remove()});let e=this.document.querySelector('link[rel="canonical"]');e&&e.remove()}removeExistingStructuredData(){let t=this.document.getElementById("structured-data-person");t&&t.remove()}getSocialMediaUrls(t){let e=[];if(t.contact_info?.website&&e.push(t.contact_info.website),t.contact_info?.linkedin){let i=t.contact_info.linkedin.startsWith("http")?t.contact_info.linkedin:`https://linkedin.com/in/${t.contact_info.linkedin}`;e.push(i)}if(t.contact_info?.twitter){let i=t.contact_info.twitter.startsWith("http")?t.contact_info.twitter:`https://twitter.com/${t.contact_info.twitter}`;e.push(i)}if(t.contact_info?.instagram){let i=t.contact_info.instagram.startsWith("http")?t.contact_info.instagram:`https://instagram.com/${t.contact_info.instagram}`;e.push(i)}return e}extractSkillsFromCard(t){let e=[];if(t.about_info?.skills&&Array.isArray(t.about_info.skills)&&e.push(...t.about_info.skills),t.about_info?.description){let n=this.extractSkillsFromDescription(t.about_info.description);e.push(...n)}return[...new Set(e)].slice(0,8)}extractSkillsFromDescription(t){if(!t)return[];let e=["javascript","typescript","angular","react","vue","node","python","php","java","html","css","sass","tailwind","bootstrap","desarrollo","programaci\xF3n","dise\xF1o","marketing","seo","ux","ui","gesti\xF3n","liderazgo","an\xE1lisis","consultor\xEDa","estrategia"],i=[],n=t.toLowerCase();return e.forEach(p=>{n.includes(p)&&i.push(p.charAt(0).toUpperCase()+p.slice(1))}),i.slice(0,5)}handleError(t){this.error.set(t),this.isLoading.set(!1),this.cardData.set(null),this.title.setTitle("Tarjeta no encontrada"),this.meta.updateTag({name:"description",content:"La tarjeta digital solicitada no est\xE1 disponible."})}ngOnDestroy(){this.manifestService.removeOldManifestURL()}static \u0275fac=function(e){return new(e||a)};static \u0275cmp=v({type:a,selectors:[["app-public-card"]],standalone:!0,features:[x],decls:5,vars:2,consts:[[1,"min-h-screen","bg-gradient-to-br","from-slate-900","via-purple-900","to-slate-900"],[1,"flex","justify-center","items-center","min-h-screen"],[1,"flex","flex-col","items-center","justify-center","min-h-screen","text-center","px-4"],[1,"relative","z-10","flex","justify-center","items-center","min-h-screen","py-8","px-4"],[3,"userCard"],["message","Cargando tarjeta digital..."],[1,"max-w-md"],[1,"text-6xl","font-bold","text-white","mb-4"],[1,"text-2xl","font-semibold","text-gray-300","mb-4"],[1,"text-gray-400","mb-8"],["routerLink","/",1,"bg-purple-600","hover:bg-purple-700","text-white","font-medium","py-3","px-6","rounded-lg","transition-colors","duration-200"],[3,"cardData","hideShareButtons","shareUrl"]],template:function(e,i){e&1&&(r(0,"div",0),C(1,H,2,0,"div",1)(2,Q,10,1,"div",2)(3,X,2,3,"div",3),s(),g(4,"app-pwa-install",4)),e&2&&(m(),T(i.isLoading()?1:i.error()?2:3),m(3),u("userCard",i.cardData()))},dependencies:[k,M,P,L],styles:["[_nghost-%COMP%]{display:block;min-height:100vh}"]})}});Y();export{A as PublicCardComponent};
