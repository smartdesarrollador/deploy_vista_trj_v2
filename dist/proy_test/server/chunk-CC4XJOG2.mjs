import './polyfills.server.mjs';
import{a as z}from"./chunk-QG6R5UVU.mjs";import{a as A}from"./chunk-WBUT2LNE.mjs";import{J as G,c as q,f as Q,g as U,k as w,m as l,r as B}from"./chunk-7IPQHCPP.mjs";import{$a as m,Ba as L,Ga as s,Ha as O,N as C,S as R,T as g,Ua as S,Wa as D,X as y,Xa as M,Za as n,_a as o,ab as F,bb as h,cb as E,db as p,eb as f,fa as $,fb as N,ga as j,ha as x,hb as _,ia as k,j as T,k as u,n as d,v as c,va as I}from"./chunk-NT3FEOQE.mjs";function J(r,t){if(r&1){let e=F();n(0,"button",19),h("click",function(){let a=$(e).$implicit,b=E(2);return j(b.selectAction(a))}),n(1,"span",20),p(2),o(),n(3,"div")(4,"div",21),p(5),o(),n(6,"div",22),p(7),o()()()}if(r&2){let e=t.$implicit,i=E(2);M("bg-cyan-600",i.currentAction.id===e.id)("text-white",i.currentAction.id===e.id)("text-gray-300",i.currentAction.id!==e.id)("hover:bg-gray-700",i.currentAction.id!==e.id),s(2),f(e.icon),s(3),f(e.label),s(2),f(e.description)}}function K(r,t){if(r&1&&(n(0,"div",16)(1,"div",17),S(2,J,8,11,"button",18),o()()),r&2){let e=E();s(2),D("ngForOf",e.qrActions)}}var V=class r{constructor(t,e){this.platformId=t;this.document=e;this.currentAction={id:"vcard",label:"Guardar Contacto",description:"Cargando...",icon:"\u{1F464}",data:"",type:"vcard"}}userCard=null;showActions=!1;currentQRSvg="";currentAction;qrActions=[];ngOnInit(){this.userCard&&(this.initializeQRActions(),this.currentAction=this.qrActions[0]||this.currentAction,this.generateQRCode(this.currentAction.data))}initializeQRActions(){if(!this.userCard?.personal_info)return;let t=this.userCard.personal_info.name,e=encodeURIComponent(`Hola ${t}, vi tu tarjeta digital y me interesa conocer m\xE1s sobre tus servicios.`),i=this.getBaseUrl();this.qrActions=[{id:"vcard",label:"Guardar Contacto",description:`Escan\xE9ame para guardar el contacto de ${t}`,icon:"\u{1F464}",data:`${i}/tarjeta/${this.userCard.slug}`,type:"vcard"},{id:"website",label:"Visitar Portfolio",description:`Escan\xE9ame para visitar el portfolio de ${t}`,icon:"\u{1F310}",data:this.userCard.contact_info?.website||`${i}/tarjeta/${this.userCard.slug}`,type:"url"},{id:"whatsapp",label:"WhatsApp Directo",description:`Escan\xE9ame para escribir a ${t} por WhatsApp`,icon:"\u{1F4AC}",data:`https://wa.me/${this.userCard.contact_info?.whatsapp?.replace(/[^0-9]/g,"")}?text=${e}`,type:"whatsapp"},{id:"vcf-inline",label:"Contacto Offline",description:"Escan\xE9ame para guardar contacto (funciona sin internet)",icon:"\u{1F4F1}",data:this.generateInlineVCard(),type:"vcf-inline"}]}getBaseUrl(){return l(this.platformId)?window.location.origin:A.siteUrl||"https://tarjeta-holografico.smartdigitaltec.com"}toggleActions(){this.showActions=!this.showActions}selectAction(t){this.currentAction=t,this.generateQRCode(t.data),this.showActions=!1}generateQRCode(t){if(!l(this.platformId))return;let e=`https://api.qrserver.com/v1/create-qr-code/?size=300x300&data=${encodeURIComponent(t)}&bgcolor=FFFFFF&color=000000&format=png&ecc=M&margin=1`;this.currentQRSvg=`
      <div class="qr-loading relative">
        <!-- Loading placeholder -->
        <div class="absolute inset-0 flex items-center justify-center bg-gray-100 rounded-lg animate-pulse">
          <div class="text-2xl">\u23F3</div>
        </div>
        
        <!-- QR Image -->
        <img src="${e}" 
             alt="${this.currentAction.description}" 
             class="qr-image w-full h-full rounded-lg shadow-sm relative z-10" 
             style="opacity: 0; transition: opacity 0.5s ease;"
             onerror="this.style.display='none'; this.parentElement.querySelector('.qr-fallback').style.display='flex';" 
             onload="this.style.opacity='1'; this.parentElement.querySelector('.animate-pulse').style.display='none';">
        
        <!-- Fallback -->
        <div class="qr-fallback hidden absolute inset-0 flex items-center justify-center bg-gradient-to-br from-cyan-100 to-purple-100 rounded-lg flex-col border-2 border-dashed border-cyan-300">
          <div class="text-3xl mb-2">${this.currentAction.icon}</div>
          <div class="text-sm text-gray-700 font-medium text-center px-4">
            ${this.currentAction.label}
          </div>
          <div class="text-xs text-gray-500 mt-1 text-center px-4">
            ${this.currentAction.description}
          </div>
        </div>
      </div>
    `}generateInlineVCard(){if(!this.userCard?.personal_info)return"";let t=this.userCard.personal_info,e=this.userCard.contact_info,i=this.userCard.about_info;return`BEGIN:VCARD
VERSION:3.0
FN:${t.name}
N:${t.name};;;;
ORG:${t.title&&t.title.split(" - ")[0]||""}
TITLE:${t.title?t.title.split(" - ")[1]||t.title:""}
TEL;TYPE=CELL:${e?.whatsapp||e?.phone||""}
EMAIL:${e?.email||""}
URL:${e?.website||`${this.getBaseUrl()}/tarjeta/${this.userCard.slug}`}
ADR;TYPE=HOME:;;${t.location||""};;PE;
NOTE:${i?.description||""}
${e?.facebook?`X-SOCIALPROFILE;TYPE=facebook:${e.facebook}`:""}
${e?.instagram?`X-SOCIALPROFILE;TYPE=instagram:${e.instagram}`:""}
${e?.linkedin?`X-SOCIALPROFILE;TYPE=linkedin:${e.linkedin}`:""}
${e?.twitter?`X-SOCIALPROFILE;TYPE=twitter:${e.twitter}`:""}
${e?.youtube?`X-SOCIALPROFILE;TYPE=youtube:${e.youtube}`:""}
${e?.github?`X-SOCIALPROFILE;TYPE=github:${e.github}`:""}
END:VCARD`.replace(/\n/g,"%0A")}static \u0275fac=function(e){return new(e||r)(O(I),O(q))};static \u0275cmp=y({type:r,selectors:[["app-dynamic-qr"]],inputs:{userCard:"userCard"},standalone:!0,features:[_],decls:20,vars:5,consts:[[1,"qr-container","relative"],[1,"qr-display","bg-white","p-4","rounded-2xl","shadow-lg","border","border-cyan-500/20","relative","overflow-hidden"],[1,"absolute","inset-0","bg-gradient-to-br","from-cyan-500/5","via-purple-500/5","to-pink-500/5"],[1,"relative","z-10","flex","justify-center"],[1,"qr-code-svg","w-48","h-48","md:w-56","md:h-56","flex","items-center","justify-center","transition-all","duration-300",3,"innerHTML"],[1,"mt-4","text-center","relative","z-10"],[1,"text-gray-700","text-sm","font-medium"],[1,"flex","items-center","justify-center","mt-2"],[1,"text-cyan-600","text-xs"],[1,"text-gray-600","text-xs","ml-1","font-medium"],[1,"mt-4","flex","flex-col","items-center"],[1,"flex","items-center","px-4","py-2","bg-gradient-to-r","from-cyan-600","to-purple-600","text-white","rounded-full","hover:from-cyan-700","hover:to-purple-700","transition-all","transform","hover:scale-105","shadow-lg",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-4","h-4","mr-2"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M8 9l4-4 4 4m0 6l-4 4-4-4"],[1,"text-sm","font-medium"],["class","mt-3 bg-gray-900/90 backdrop-blur-sm rounded-xl border border-cyan-500/20 overflow-hidden shadow-2xl animate-fade-in",4,"ngIf"],[1,"mt-3","bg-gray-900/90","backdrop-blur-sm","rounded-xl","border","border-cyan-500/20","overflow-hidden","shadow-2xl","animate-fade-in"],[1,"p-2","space-y-1"],["class","w-full flex items-center px-4 py-3 rounded-lg transition-colors text-left",3,"bg-cyan-600","text-white","text-gray-300","hover:bg-gray-700","click",4,"ngFor","ngForOf"],[1,"w-full","flex","items-center","px-4","py-3","rounded-lg","transition-colors","text-left",3,"click"],[1,"text-lg","mr-3"],[1,"font-medium","text-sm"],[1,"text-xs","opacity-75"]],template:function(e,i){e&1&&(n(0,"div",0)(1,"div",1),m(2,"div",2),n(3,"div",3),m(4,"div",4),o(),n(5,"div",5)(6,"p",6),p(7),o(),n(8,"div",7)(9,"span",8),p(10),o(),n(11,"span",9),p(12),o()()()(),n(13,"div",10)(14,"button",11),h("click",function(){return i.toggleActions()}),x(),n(15,"svg",12),m(16,"path",13),o(),k(),n(17,"span",14),p(18,"Cambiar acci\xF3n"),o()(),S(19,K,3,1,"div",15),o()()),e&2&&(s(4),D("innerHTML",i.currentQRSvg,L),s(3),N(" ",i.currentAction.description," "),s(3),f(i.currentAction.icon),s(2),f(i.currentAction.label),s(7),D("ngIf",i.showActions))},dependencies:[w,Q,U],styles:['.qr-container[_ngcontent-%COMP%]{max-width:320px;margin:0 auto}.qr-display[_ngcontent-%COMP%]:before{content:"";position:absolute;inset:-2px;background:linear-gradient(45deg,#0ff,#ff0080,#8000ff,#0ff);background-size:400% 400%;border-radius:18px;z-index:-1;animation:_ngcontent-%COMP%_borderGlow 3s ease-in-out infinite;opacity:.7}@keyframes _ngcontent-%COMP%_borderGlow{0%,to{background-position:0% 50%}50%{background-position:100% 50%}}.animate-fade-in[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_fadeIn .3s ease-out}@keyframes _ngcontent-%COMP%_fadeIn{0%{opacity:0;transform:translateY(-10px)}to{opacity:1;transform:translateY(0)}}.qr-code-svg[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{width:100%;height:100%;border-radius:8px}@media (max-width: 768px){.qr-container[_ngcontent-%COMP%]{max-width:280px}.qr-code-svg[_ngcontent-%COMP%]{width:180px!important;height:180px!important}}']})};var Y=class r{currentSlug="";router=g(G);cardRoutes=["tarjeta","tarjeta-dos","tarjeta-tres"];cambiarTarjeta(){if(!this.currentSlug)return;let t=this.getCurrentRoute(),e=this.cardRoutes.indexOf(t);if(e===-1)return;let i=(e+1)%this.cardRoutes.length,a=this.cardRoutes[i];this.router.navigate([`/${a}`,this.currentSlug])}getCurrentRoute(){let t=this.router.url;for(let e of this.cardRoutes)if(t.includes(`/${e}/`))return e;return""}static \u0275fac=function(e){return new(e||r)};static \u0275cmp=y({type:r,selectors:[["app-cambiar-tarjeta"]],inputs:{currentSlug:"currentSlug"},standalone:!0,features:[_],decls:3,vars:0,consts:[["title","Cambiar acci\xF3n",1,"flex","items-center","justify-center","w-12","h-12","bg-blue-600","hover:bg-blue-700","text-white","rounded-full","transition-colors","shadow-lg",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-5","h-5","transform"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M8 7h12m0 0l-4-4m4 4l-4 4m0 6H4m0 0l4 4m-4-4l4-4"]],template:function(e,i){e&1&&(n(0,"button",0),h("click",function(){return i.cambiarTarjeta()}),x(),n(1,"svg",1),m(2,"path",2),o()())},dependencies:[w]})};var H=class r{apiService=g(z);http=g(B);DIGITAL_CARDS_ENDPOINT="digital-cards";baseUrl=A.apiUrl;constructor(){}getUserDigitalCards(){return this.apiService.get(this.DIGITAL_CARDS_ENDPOINT).pipe(d(t=>t.data),c(t=>(console.error("Error obteniendo tarjetas digitales:",t),u(()=>t))))}getDigitalCardBySlug(t){return this.http.get(`${this.baseUrl}/tarjetas/${t}`).pipe(d(e=>e.data),c(e=>(console.error("Error obteniendo tarjeta digital por slug:",e),T(null))))}getDigitalCardById(t){return this.apiService.get(`${this.DIGITAL_CARDS_ENDPOINT}/${t}`).pipe(d(e=>e.data),c(e=>(console.error("Error obteniendo tarjeta digital:",e),u(()=>e))))}createDigitalCard(t){return this.apiService.post(this.DIGITAL_CARDS_ENDPOINT,t).pipe(d(e=>e.data),c(e=>(console.error("Error creando tarjeta digital:",e),u(()=>e))))}updateDigitalCard(t,e){return this.apiService.put(`${this.DIGITAL_CARDS_ENDPOINT}/${t}`,e).pipe(d(i=>i.data),c(i=>(console.error("Error actualizando tarjeta digital:",i),u(()=>i))))}deleteDigitalCard(t){return this.apiService.delete(`${this.DIGITAL_CARDS_ENDPOINT}/${t}`).pipe(d(()=>!0),c(e=>(console.error("Error eliminando tarjeta digital:",e),u(()=>e))))}toggleDigitalCardStatus(t,e){return this.apiService.put(`${this.DIGITAL_CARDS_ENDPOINT}/${t}/toggle-status`,e).pipe(d(i=>i.data),c(i=>(console.error("Error cambiando estado de tarjeta digital:",i),u(()=>i))))}getDigitalCardData(){return this.getDigitalCardBySlug("jeans-malon-reyna").pipe(c(t=>(console.error("Error obteniendo datos de tarjeta:",t),T(null))))}validateDigitalCard(t){return!(!t||typeof t!="object"||typeof t.id!="number"||!t.slug||typeof t.is_active!="boolean"||typeof t.is_public!="boolean"||t.personal_info!==null&&(!t.personal_info||!t.personal_info.name)||t.contact_info!==null&&t.contact_info&&!t.contact_info.email&&!t.contact_info.phone||t.about_info&&t.about_info!==null&&(!Array.isArray(t.about_info.skills)||typeof t.about_info.experience!="number"))}validateCreateDigitalCardData(t){return!(!t||typeof t!="object"||!t.personal_info||!t.personal_info.name||t.about_info&&t.about_info.skills&&!Array.isArray(t.about_info.skills))}static \u0275fac=function(e){return new(e||r)};static \u0275prov=C({token:r,factory:r.\u0275fac,providedIn:"root"})};var X=class r{constructor(t){this.platformId=t}isMobileDevice(){return l(this.platformId)?/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)||window.innerWidth<768:!1}prefersReducedMotion(){return l(this.platformId)?window.matchMedia("(prefers-reduced-motion: reduce)").matches:!0}shouldUseReducedAnimations(){return this.isMobileDevice()||this.prefersReducedMotion()}setupLazyLoading(){if(!l(this.platformId))return;let t=document.querySelectorAll("img[data-src]");if("IntersectionObserver"in window){let e=new IntersectionObserver((i,a)=>{i.forEach(b=>{if(b.isIntersecting){let v=b.target;v.src=v.dataset.src||"",v.classList.remove("lazy"),e.unobserve(v)}})});t.forEach(i=>e.observe(i))}else t.forEach(e=>{e.src=e.dataset.src})}preloadCriticalResources(){if(!l(this.platformId))return;[].forEach(e=>{let i=document.createElement("link");i.rel="preload",i.href=e,i.as="image",document.head.appendChild(i)})}debounce(t,e){let i;return(...a)=>{clearTimeout(i),i=setTimeout(()=>t.apply(null,a),e)}}throttle(t,e){let i;return(...a)=>{i||(t.apply(null,a),i=!0,setTimeout(()=>i=!1,e))}}measurePageLoad(){l(this.platformId)&&window.addEventListener("load",()=>{let t=performance.getEntriesByType("navigation")[0],e={domContentLoaded:t.domContentLoadedEventEnd-t.domContentLoadedEventStart,loadComplete:t.loadEventEnd-t.loadEventStart,totalPageLoad:t.loadEventEnd-t.fetchStart,firstPaint:this.getFirstPaint(),firstContentfulPaint:this.getFirstContentfulPaint()};console.log("Performance Metrics:",e)})}getFirstPaint(){let e=performance.getEntriesByType("paint").find(i=>i.name==="first-paint");return e?e.startTime:0}getFirstContentfulPaint(){let e=performance.getEntriesByType("paint").find(i=>i.name==="first-contentful-paint");return e?e.startTime:0}optimizeFonts(){if(!l(this.platformId))return;["https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap"].forEach(e=>{let i=document.createElement("link");i.rel="preload",i.href=e,i.as="style",i.crossOrigin="anonymous",document.head.appendChild(i),setTimeout(()=>{let a=document.createElement("link");a.rel="stylesheet",a.href=e,document.head.appendChild(a)},100)})}static \u0275fac=function(e){return new(e||r)(R(I))};static \u0275prov=C({token:r,factory:r.\u0275fac,providedIn:"root"})};export{V as a,Y as b,H as c,X as d};
