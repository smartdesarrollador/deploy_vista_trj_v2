import './polyfills.server.mjs';
import{a as w}from"./chunk-WBUT2LNE.mjs";import{m as l,r as v}from"./chunk-7IPQHCPP.mjs";import{H as m,N as s,S as g,T as a,c as u,da as b,j as p,ma as y,n as f,v as d,va as h}from"./chunk-NT3FEOQE.mjs";function D(n){n||(b(D),n=a(y));let e=new u(t=>n.onDestroy(t.next.bind(t)));return t=>t.pipe(m(e))}var j=class n{http=a(v);baseUrl=w.apiUrl;getDigitalCardBySlug(e){return this.http.get(`${this.baseUrl}/tarjetas/${e}`).pipe(f(t=>!t||!t.data?null:t.data),d(t=>(console.error("Error obteniendo tarjeta digital p\xFAblica:",t),p(null))))}validateDigitalCard(e){return!(!e||typeof e!="object"||typeof e.id!="number"||!e.slug||typeof e.is_active!="boolean"||typeof e.is_public!="boolean"||!e.is_active||!e.is_public||!e.personal_info||!e.personal_info.name)}static \u0275fac=function(t){return new(t||n)};static \u0275prov=s({token:n,factory:n.\u0275fac,providedIn:"root"})};var k=class n{constructor(e){this.platformId=e}generateDynamicManifest(e,t){if(!e)return null;let r=e.name||e.nombre||"Usuario",i=e.title||e.cargo||"Profesional",o=e.location||e.ubicacion||"";return{name:`${r} - Tarjeta Digital`,short_name:r,description:`Tarjeta digital profesional de ${r}, ${i}${o?" en "+o:""}. Acceso directo a toda su informaci\xF3n de contacto.`,start_url:t,display:"standalone",orientation:"portrait-primary",theme_color:"#00ffff",background_color:"#000000",scope:"/",lang:"es-ES",dir:"ltr",categories:["business","productivity","social"],prefer_related_applications:!1,icons:[{src:"assets/pwa/apple-touch-icon-180x180.png",sizes:"180x180",type:"image/png",purpose:"any"},{src:"assets/pwa/icon_JE_192.png",sizes:"192x192",type:"image/png",purpose:"any"},{src:"assets/pwa/icon_JE_512_maskable.png",sizes:"512x512",type:"image/png",purpose:"maskable"},{src:"assets/pwa/icon_JE_512.png",sizes:"512x512",type:"image/png",purpose:"any"},{src:"assets/pwa/logo_JE_1024.png",sizes:"1024x1024",type:"image/png",purpose:"any"}],shortcuts:[{name:`Ver Tarjeta de ${r}`,short_name:"Tarjeta",description:`Acceso directo a la tarjeta digital de ${r}`,url:t,icons:[{src:"assets/pwa/icon_JE_192.png",sizes:"192x192",type:"image/png"}]}],share_target:{action:t,method:"GET",params:{title:"title",text:"text",url:"url"}},screenshots:[{src:"assets/pwa/screenshot-wide.png",sizes:"1280x720",type:"image/png",form_factor:"wide",label:`Vista desktop de la tarjeta digital de ${r}`},{src:"assets/pwa/screenshot-narrow.png",sizes:"360x640",type:"image/png",form_factor:"narrow",label:`Vista m\xF3vil de la tarjeta digital de ${r}`}],protocol_handlers:[{protocol:"mailto",url:`${t}?email=%s`}]}}updateManifestLink(e,t){if(!l(this.platformId))return;let r=this.generateDynamicManifest(e,t);if(!r)return;let i=document.querySelector('link[rel="manifest"]');i&&i.remove();let o=new Blob([JSON.stringify(r,null,2)],{type:"application/json"}),x=URL.createObjectURL(o),c=document.createElement("link");c.rel="manifest",c.href=x,document.head.appendChild(c),console.log("[Manifest] Updated dynamic manifest for user:",e.name||e.nombre),console.log("[Manifest] Start URL:",t)}removeOldManifestURL(){if(!l(this.platformId))return;let e=document.querySelector('link[rel="manifest"]');e&&e.href.startsWith("blob:")&&URL.revokeObjectURL(e.href)}static \u0275fac=function(t){return new(t||n)(g(h))};static \u0275prov=s({token:n,factory:n.\u0275fac,providedIn:"root"})};export{D as a,j as b,k as c};
